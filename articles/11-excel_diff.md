---
title: "差分チェックをExcelで行う方法"
emoji: "🎉"
type: "idea" # tech: 技術記事 / idea: アイデア
topics: [AWS, Excel, スプレッドシート, 生産性向上, 効率化]
published: true
---

## 前提

現場で管理しているSecrets Manager情報一覧のシートと、AWSマネジメントコンソール上のSecrets Managerの個数に乖離があることを発見しました。  
これらを手動で確認するのは時間がかかり効率が悪いため、不足しているSecrets Manager名を効率的に割り出す方法を履歴として残しておきます。

> 💡 **備考**: Googleスプレッドシートでも同様の方法が使えます！

## シートへ関数を設定

まずはExcelシートを開き、以下のようなレイアウトで値を入力します：

- A列: AWSマネジメントコンソールから取得したSecrets Manager名
- B列: 管理資料に記載されているSecrets Manager名

差分の確認対象によって手順が異なるため、いくつかのパターンに分けて紹介します。  
今回の事象については、【方法1】に該当します。

### 【方法1：COUNTIF関数を使用した差分チェック】

1. AWS側にあって管理資料にないものをチェック（C列に入力）:

```excel
=IF(COUNTIF(B:B, A2)=0, "管理資料に未記載", "")
```

2. 管理資料にあってAWS側にないものをチェック（D列に入力）:

```excel
=IF(COUNTIF(A:A, B2)=0, "AWSに未登録", "")
```

### 【方法2：MATCH関数を使用した差分チェック】

A列のSecrets Manager名がB列に存在するか確認（C列に入力）:

```excel
=IF(ISNA(MATCH(A2, B:B, 0)), "管理資料に未記載", "")
```

### 【方法3：条件付き書式による視覚的差分強調】

1. A列を選択
2. 条件付き書式 → 新しいルール → 数式を使用
3. 数式に以下を入力:

```excel
=COUNTIF(B:B, A1)=0
```

4. 書式を赤色などに設定

同様にB列にも設定することで、差分が視覚的に確認可能。

---

以上の方法により、AWS Secrets Manager名と管理資料の差分を効率的に確認できます。
